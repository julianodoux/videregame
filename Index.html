<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle de Sorvetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
body{
    font-family:Arial,sans-serif;
    background:#f2f2f7;
    padding:10px;
    max-width:480px;
    margin:auto;
    color:#333;
}

h1{
    text-align:center;
    margin-bottom:15px;
}

/* BOTÃO CATEGORIA */
.cat-btn{
    width:100%;
    background:#007aff;
    color:#fff;
    padding:14px;
    font-size:18px;
    border:none;
    border-radius:14px;
    margin-top:12px;
    font-weight:bold;
}

/* BLOCO CATEGORIA */
.categoria{
    display:none;
    background:#e8f0ff;
    padding:8px;
    border-radius:14px;
    margin-top:6px;
}

/* ITEM */
.item{
    display:flex;
    justify-content:space-between;
    gap:8px;
    background:#fff;
    padding:10px;
    margin-top:8px;
    border-radius:12px;
    box-shadow:0 2px 6px rgba(0,0,0,.12);
}

.item.zero{
    background:#ff4d4d;
    color:#fff;
}

/* INFO ESQUERDA */
.info{
    flex:1;
}

.nome{
    font-size:17px;
    font-weight:bold;
}

.valor{
    font-size:14px;
    color:#007aff;
}

.restante{
    font-size:14px;
    font-weight:bold;
}

/* CONTROLES */
.controles{
    width:115px;
    background:#f1f1f1;
    border-radius:12px;
    padding:6px;
}

.linha{
    display:flex;
    align-items:center;
    justify-content:space-between;
    font-size:12px;
    margin-bottom:6px;
}

.btn{
    width:28px;
    height:28px;
    border:none;
    border-radius:8px;
    font-size:18px;
    font-weight:bold;
    color:#fff;
}

.menos{background:#ff3b30;}
.mais{background:#007aff;}

.numero{
    width:22px;
    text-align:center;
    font-weight:bold;
}

/* CAIXAS */
.caixa-info{
    background:#e6fff0;
    padding:14px;
    border-radius:14px;
    margin-top:15px;
    text-align:center;
    font-size:18px;
    font-weight:bold;
}

#limpar,#relatorio{
    width:100%;
    margin-top:15px;
    padding:14px;
    border:none;
    border-radius:14px;
    font-size:18px;
    font-weight:bold;
    color:#fff;
}

#limpar{background:#ff3b30;}
#relatorio{background:#5856d6;}

/* POPUP */
#popupRelatorio{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.6);
    padding:20px;
    z-index:9999;
}
</style>

<script>
let precoPorCategoria={
 "PALETAS FRUTIVERÃO":18,
 "AO LEITE FRUTIVERÃO":8,
 "TROPICAL FRUTIVERÃO":6,
 "ESPECIAL FRUTVERÃO":13,
 "LANÇAMENTOS":null
};

let precosLancamentos={
 "Pistache":16,
 "Unicórnio":10
};

let categorias={
 "PALETAS FRUTIVERÃO":["Raffaello","Oreo","Ferrero","Kinder Ovo","Kinder Bueno","M&M","Choco Maltine","Milk Trufado","Babalu","Blue Ice","Sensação","Morango","Maracujá","Açaí","Iogurte c/ Amora","Menta c/ Chocolate","Paçoca","Capuccino","Banana com Avelã","Coco c/ Abobora","Coco c/ Doce de Leite","Tapioca","Abacaxi Zero"],
 "AO LEITE FRUTIVERÃO":["Morango","Chocolate","Leite Condensado","Milho-Verde","Açaí c/ Morango","Coco","Coco Queimado","Abóbora c/ Coco","Amendoim","Abacate","Blue Ice"],
 "TROPICAL FRUTIVERÃO":["Uva","Limão","Maracujá","Manga","Abacaxi","Melancia","Tangerina","Maçã Verde","Groselha","Tutti Frutti","Pinta Língua"],
 "ESPECIAL FRUTVERÃO":["Skimo morango","Skimo ao leite","Milk trufado","Brigadeiro","Chococo","Torta de limão","Itu napolitano","Frutblito","Sunday de chocolate","Sundae de Morango"],
 "LANÇAMENTOS":["Pistache","Unicórnio"]
};

let id=1;
let estoque=JSON.parse(localStorage.getItem("estoque"))||{};
let vendido=JSON.parse(localStorage.getItem("vendido"))||{};
let total=Number(localStorage.getItem("totalVendas"))||0;

function toggle(cat){
 let el=document.getElementById("cat_"+cat);
 el.style.display=el.style.display==="block"?"none":"block";
}

function atualizar(id){
 let e=Number(document.getElementById("est_"+id).innerText);
 let v=Number(document.getElementById("vend_"+id).innerText);
 let r=Math.max(0,e-v);

 document.getElementById("resto_"+id).innerText="Restante: "+r;

 let item=document.getElementById("item_"+id);
 r===0?item.classList.add("zero"):item.classList.remove("zero");

 estoque[id]=e;
 vendido[id]=v;
 salvar();
 recalcular();
}

function add(tipo,id){
 let el=document.getElementById(tipo+"_"+id);
 el.innerText=Number(el.innerText)+1;
 atualizar(id);
}

function remove(tipo,id){
 let el=document.getElementById(tipo+"_"+id);
 if(Number(el.innerText)>0) el.innerText--;
 atualizar(id);
}

function salvar(){
 localStorage.setItem("estoque",JSON.stringify(estoque));
 localStorage.setItem("vendido",JSON.stringify(vendido));
 localStorage.setItem("totalVendas",total);
}

function recalcular(){
 total=0;
 let i=1;
 for(let cat in categorias){
   categorias[cat].forEach(s=>{
     let preco=precoPorCategoria[cat];
     if(cat==="LANÇAMENTOS") preco=precosLancamentos[s];
     total+=(vendido[i]||0)*preco;
     i++;
   });
 }
 document.getElementById("valorTotal").innerText=total.toFixed(2);
}

function limparTudo(){
 localStorage.clear();
 location.reload();
}
</script>
</head>

<body>

<h1>Controle de Sorvetes</h1>

<script>
for(let cat in categorias){
 document.write(`<button class="cat-btn" onclick="toggle('${cat}')">${cat}</button>`);
 document.write(`<div class="categoria" id="cat_${cat}">`);

 categorias[cat].forEach(s=>{
  let preco=precoPorCategoria[cat];
  if(cat==="LANÇAMENTOS") preco=precosLancamentos[s];

  let e=estoque[id]||0;
  let v=vendido[id]||0;
  let r=Math.max(0,e-v);

  document.write(`
  <div class="item ${r===0?"zero":""}" id="item_${id}">
    <div class="info">
        <div class="nome">${s}</div>
        <div class="valor">Preço: R$ ${preco}</div>
        <div class="restante" id="resto_${id}">Restante: ${r}</div>
    </div>

    <div class="controles">
        <div class="linha">
            <span>Estoque</span>
            <button class="btn menos" onclick="remove('est',${id})">-</button>
            <span class="numero" id="est_${id}">${e}</span>
            <button class="btn mais" onclick="add('est',${id})">+</button>
        </div>
        <div class="linha">
            <span>Vendido</span>
            <button class="btn menos" onclick="remove('vend',${id})">-</button>
            <span class="numero" id="vend_${id}">${v}</span>
            <button class="btn mais" onclick="add('vend',${id})">+</button>
        </div>
    </div>
  </div>
  `);
  id++;
 });

 document.write(`</div>`);
}
</script>

<div class="caixa-info">
 TOTAL EM VENDAS: R$ <span id="valorTotal">0.00</span>
</div>

<button id="limpar" onclick="limparTudo()">LIMPAR TUDO</button>

<script>recalcular();</script>

</body>
</html>